<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no" />
  <title>登录</title>
  <link rel="stylesheet" href="css/style.css">
  <script type="text/javascript" src="js/jquery-1.9.1.js"></script>
  <script type="text/javascript" src="js/rem.js"></script>
  <script type="text/javascript" src="js/template-web.js"></script>
  <script type="text/javascript" src="js/commen.js"></script>
  <script type="text/javascript" src="js/md5.min.js"></script>
</head>

<body>
<div class="b_login">
  <div class="b_login_div">
    <input type="text" placeholder="请输入手机号或用户名" class="b_login-input user-img" id="username">
  </div>
  <div class="b_login_div">
    <input type="password" placeholder="请输入密码" class="b_login-input password-img small-width" id="password">
    <img src="images/yjj@3x.png" class="eye-password" id="eye" onClick="b_eye()">
  </div>
  <div class="b_reminder"></div>
  <input type="button" value="登录" class="b_mom_btn" id="submit-login">
  <div class="b_other"><a class="color_gray" href="new-password.html">忘记密码?</a> <a href="register.html" class="color_red">手机快速注册</a></div>
  <div class="b_reminder-msg">
    <div class="b-msg"></div>
  </div>
</div>
<script>

  $(function() {
    
    $("#submit-login").on('click', function(e) {
      e.preventDefault(); //阻止本来自带事件
      var username = $("#username").val();
      var password = $("#password").val();
      var md5paswd = md5(password).toUpperCase(); //将密码进行md5加密，并将字母转换为大写。toUpperCase()方法用于把字符串转换为大写。
      if (username == "") {
        $(".b-msg").empty() //每次将内容清空
        $(".b-msg").html("请输入用户名/手机号").show().delay(2000).fadeOut()
      } else if (password == "") {
        $(".b-msg").empty() //每次将内容清空
        $(".b-msg").html("密码不能为空").show().delay(2000).fadeOut()
      } else {
        $.ajax({
          url: AjaxUrl + 'Login',
          type: 'POST',
          dataType: 'json',
          data: {
            "mobile": username,
            "password": md5paswd,
            "i_login_resourse": 1
          },
          success: function(data) {
            console.log(data);
            if (data.status == "success") {
              set('mobile', username);
              set('loginData', data.data[0]); //存储返回来的数据信息，JSON.stringify()方法将对象转换为字符串
              var CookieValue = "UserID=" + data.data[0].i_bu_identifier + "&Pw=" + data.data[0].nvc_password_md5;
              setCookie('ChinaCeramics', CookieValue, '5'); //存储cookie
              $(".b-msg").empty() //每次将内容清空
              $(".b-msg").html(data.Msg).show().delay(2000).fadeOut()
              setTimeout("window.location='mine/user-index.html'", 1000) //页面延迟跳转，因为要把提示语展示完毕之后再跳转
            } else {
              $(".b-msg").empty() //每次将内容清空
              $(".b-msg").html(data.Msg).show().delay(2000).fadeOut()
              
              
            }
          }
        })
      }
    })
    
  })
</script>
</body>

</html>
